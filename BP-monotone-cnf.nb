(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     62521,       1568]
NotebookOptionsPosition[     61082,       1516]
NotebookOutlinePosition[     61419,       1531]
CellTagsIndexPosition[     61376,       1528]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "note", " ", "that", " ", "the", " ", "BP", " ", "update", " ", "rule", 
    " ", "is", " ", "optimized", " ", "with", " ", "a", " ", "hash", " ", 
    "table", " ", "that", " ", "is", " ", "only", " ", "available", " ", 
    "Mathematica", " ", "10"}], "+"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6648227568106728`*^9, 3.6648228154037647`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"recursion", "[", 
    RowBox[{"lst_", ",", " ", "\[Lambda]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]", " ", 
     RowBox[{"Times", "@@", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"terms", ",", 
         RowBox[{"1", "-", 
          RowBox[{"Times", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "/", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "#"}], ")"}]}], ")"}], "&"}], "/@", 
             "terms"}], ")"}]}]}]}], "]"}], "/@", "lst"}]}]}], "//", "N"}]}], 
  "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"recursion", " ", "for", " ", "monotone", " ", "CNF"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeedRandom", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "100"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "vertices"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", "9"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"degree", " ", "of", " ", "a", " ", "varialbe"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"degree", " ", "of", " ", "a", " ", "clause"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "=", 
    RowBox[{
     RowBox[{"2", "^", "6"}], "+", "1"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "multiplicative", " ", "weight", " ", "for", " ", "a", " ", "variable", 
     " ", "to", " ", "be", " ", "occupied"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "'"}], "=", 
    RowBox[{"n", "*", "d"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"total", " ", "degrees"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"m", "=", 
    RowBox[{"Ceiling", "[", 
     RowBox[{
      RowBox[{"n", "'"}], "/", "k"}], "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"number", " ", "of", " ", "clauses"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"nIter", "=", 
    RowBox[{"100", "*", 
     RowBox[{"n", "'"}]}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"number", " ", "of", " ", "iterations"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"genAdj", "[", 
     RowBox[{
     "ginc_", ",", "ginc2_", ",", "gidx_", ",", "vidx_", ",", "aidx_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"b", ",", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"i", ",", 
          RowBox[{"gidx", "[", 
           RowBox[{"{", 
            RowBox[{"i", ",", "b"}], "}"}], "]"}]}], "]"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ginc2", "[", 
           RowBox[{"[", "b", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", "vidx"}], "&"}]}], "]"}]}]}], "]"}], "/@", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"ginc", "[", 
        RowBox[{"[", "vidx", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "\[NotEqual]", "aidx"}], "&"}]}], "]"}]}]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "generate", " ", "a", " ", "list", " ", "of", " ", "values", " ", "to", 
    " ", "be", " ", "fed", " ", "into", " ", "the", " ", "recurrence"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{"True", ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "keep", " ", "sampling", " ", "until", " ", "a", " ", "simple", " ", 
     "graph"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"Graph", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["v", 
              RowBox[{"Ceiling", "[", 
               RowBox[{"#1", "/", "d"}], "]"}]], " ", "\[UndirectedEdge]", 
             " ", 
             SubscriptBox["a", 
              RowBox[{"Ceiling", "[", 
               RowBox[{"#2", "/", "k"}], "]"}]]}], ")"}], "&"}], ",", "#"}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"n", "'"}], "]"}], ",", " ", 
          RowBox[{"PermutationReplace", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"n", "'"}], "]"}], ",", 
            RowBox[{"RandomPermutation", "[", 
             RowBox[{"n", "'"}], "]"}]}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
    ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "bipartite", " ", "factor", " ", "graph", " ", "from", " ", "a", " ", 
      "random", " ", "permutation"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"SimpleGraphQ", "[", "G", "]"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"if", " ", "G", " ", "is", " ", "simple"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ginc", "=", 
        RowBox[{"Association", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"AdjacencyList", "[", 
               RowBox[{"G", ",", 
                SubscriptBox["v", "i"]}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "incidence", " ", "list", " ", "as", " ", "an", " ", "associative", 
         " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Ginc2", "=", 
        RowBox[{"Association", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"AdjacencyList", "[", 
               RowBox[{"G", ",", 
                SubscriptBox["a", "i"]}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], "]"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "transpose", " ", "of", " ", "incidence", " ", "list", " ", "as", " ",
          "an", " ", "associative", " ", "list"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Glst", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
             RowBox[{"AdjacencyList", "[", 
              RowBox[{"G", ",", 
               SubscriptBox["v", "i"]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gidx", "=", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"term", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#1", " ", "\[Rule]", " ", "#2"}], ")"}], "&"}], "@@", 
             "term"}]}], "]"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Glst", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"n", "'"}], "]"}]}], "}"}], "//", "Transpose"}], 
           ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gadj", "=", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"term", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"genAdj", "[", 
              RowBox[{
              "Ginc", ",", "Ginc2", ",", "Gidx", ",", "#1", ",", "#2"}], 
              "]"}], "&"}], "@@", "term"}]}], "]"}], "/@", "Glst"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gfunc", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"term", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"lst", ",", 
                RowBox[{"recursion", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"lst", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "term", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[Lambda]"}], 
                 "]"}]}], "]"}], "&"}], "@@", "term"}]}], "]"}], "/@", 
          "Gadj"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"a", " ", "list", " ", "of", " ", "functions"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Gratios", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", "]"}], ",", 
           RowBox[{"n", "'"}]}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "initialize", " ", "ratios", " ", "with", " ", "random", " ", 
         "reals"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"n", "'"}]}], "}"}], "]"}], "//", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Gratios", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "=", 
       RowBox[{"Gratios", "//", 
        RowBox[{"Gfunc", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}], "&"}]}], ",", "nIter"}], 
  "]"}], "\[IndentingNewLine]", "Gratios"}], "Input",
 CellChangeTimes->{{3.664814057154748*^9, 3.664814080222233*^9}, {
   3.664814171592347*^9, 3.664814175821458*^9}, {3.664814737940783*^9, 
   3.664814742901681*^9}, {3.664815004070847*^9, 3.66481505415804*^9}, {
   3.664815125926404*^9, 3.6648151663983*^9}, {3.6648152149340754`*^9, 
   3.664815268158187*^9}, {3.6648153386071253`*^9, 3.664815386206612*^9}, {
   3.664815420174559*^9, 3.664815479478324*^9}, 3.664815818485365*^9, {
   3.664815941351214*^9, 3.664815963748659*^9}, {3.664815997103326*^9, 
   3.664816026647085*^9}, {3.664816069647044*^9, 3.6648162158390636`*^9}, {
   3.6648163140468616`*^9, 3.664816417510344*^9}, {3.664816522147547*^9, 
   3.664816523411688*^9}, {3.664817114513942*^9, 3.664817212641159*^9}, {
   3.664817255168776*^9, 3.664817316781392*^9}, 3.6648173944724007`*^9, {
   3.664817970115841*^9, 3.664817993448448*^9}, 3.664818192722445*^9, {
   3.664818484594202*^9, 3.664818488191373*^9}, {3.664818599391054*^9, 
   3.664818615280167*^9}, {3.6648190961759253`*^9, 3.664819096433112*^9}, {
   3.664819242003327*^9, 3.664819298945642*^9}, {3.6648193524885406`*^9, 
   3.664819361145246*^9}, {3.664819401286357*^9, 3.6648194045058813`*^9}, {
   3.664819440397868*^9, 3.664819442454307*^9}, {3.6648194864540653`*^9, 
   3.664819488063871*^9}, {3.6648195767227707`*^9, 3.664819720554899*^9}, 
   3.6648198898405333`*^9, 3.664820314510529*^9, 3.664820687254389*^9, {
   3.664820774100739*^9, 3.66482077456927*^9}, {3.6648208150096607`*^9, 
   3.6648208436133327`*^9}, 3.664823181254867*^9}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJwV0X0s1HEAx3GplFLTljtuuRF2qRZGEsunCNP1ME/3O3dnOKzIVfIUnYcl
KqdaGRVaFKOHyS6SSA/MrsdJkafrSHe/c+f66pLWc/rjtb3/f9uLD4YmzDcx
MZk3hz3nfxtdfzv4znxAzEBNZVa+Dl/KNvpQDQTx2jeM+UwNGAUJivUuU3BO
ta3m9REcEemCtl5T4fCj2PCR11qEnSWqyFyCouQT2/v+TkBkDFltbqlH0h3/
cd5dghzf3vLuqCFo3Jy/rXOgcfEVZ1gQTpB9q0MmOfAB3Se3UI1eOjipWiyp
GgLP9ORfy0qUiDi+ZlWwnxZ1/bWzkYcI7Fsei2SraTzdOWts6ZyCb2xifcQY
gZNH7bCjcgyPRBbl4thJ5O0428ovIQj7xPb+KB6Hlrv8suP1SWQN7PtJlRKY
Xrpv+uDCeyjENxnWxVocNX2WI8gkqOCEc24HvoNipF9aU6qB7ABbLgwkqEzp
00dRY+gUyvOrbCbB+5a+PLKQgB3i08jInkBgB9chWKFDJpfdS90m0Mn3TDdp
x2Fy3/aFYXoSfh70Z6qCYIlE5ahMG4Gdxd2gVjkNxrOVTIGY4F5MnPrIUjWm
M+zKr17Ro66HlUd1E5xorijihg6CZbs3Y/+IBvW0sEO4i+BMQA+zYIMW7emL
ddm7DcgvTSkQfCJYFBu3eYXPAG6UhVq/42pQEZp6WQgCyRp/pTBxGKaH5edn
kmgYyvyfCIQEbTLXgLZmLQaD6hul5QY85Uv+RH8l4Hm3F6Q00BDO+ipKzAxo
bqo28miCAWarudc5NWg6ISee1sOSNfqQ95yg2H3UtatKg4Wbc91JxhRk2W2G
iKG575yGbWWFH/EjZMbmJaXHBL84gveAQNreblXk0g8dy7NzxQINoudVmYm8
CF4EjH1XMd+gOuF0WkyaGue7eqwi1xLUNxolfIe36H2f/NyuQw1vVo4L343g
1JJgpTR/FLYlnpxjP2hIF3VuEiQS/AOSwW/E
                "], {{0, 0}, {30, 1}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["900", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "900", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJwV0X0s1HEAx3GplFLTljtuuRF2qRZGEsunCNP1ME/3O3dnOKzIVfIUnYcl
KqdaGRVaFKOHyS6SSA/MrsdJkafrSHe/c+f66pLWc/rjtb3/f9uLD4YmzDcx
MZk3hz3nfxtdfzv4znxAzEBNZVa+Dl/KNvpQDQTx2jeM+UwNGAUJivUuU3BO
ta3m9REcEemCtl5T4fCj2PCR11qEnSWqyFyCouQT2/v+TkBkDFltbqlH0h3/
cd5dghzf3vLuqCFo3Jy/rXOgcfEVZ1gQTpB9q0MmOfAB3Se3UI1eOjipWiyp
GgLP9ORfy0qUiDi+ZlWwnxZ1/bWzkYcI7Fsei2SraTzdOWts6ZyCb2xifcQY
gZNH7bCjcgyPRBbl4thJ5O0428ovIQj7xPb+KB6Hlrv8suP1SWQN7PtJlRKY
Xrpv+uDCeyjENxnWxVocNX2WI8gkqOCEc24HvoNipF9aU6qB7ABbLgwkqEzp
00dRY+gUyvOrbCbB+5a+PLKQgB3i08jInkBgB9chWKFDJpfdS90m0Mn3TDdp
x2Fy3/aFYXoSfh70Z6qCYIlE5ahMG4Gdxd2gVjkNxrOVTIGY4F5MnPrIUjWm
M+zKr17Ro66HlUd1E5xorijihg6CZbs3Y/+IBvW0sEO4i+BMQA+zYIMW7emL
ddm7DcgvTSkQfCJYFBu3eYXPAG6UhVq/42pQEZp6WQgCyRp/pTBxGKaH5edn
kmgYyvyfCIQEbTLXgLZmLQaD6hul5QY85Uv+RH8l4Hm3F6Q00BDO+ipKzAxo
bqo28miCAWarudc5NWg6ISee1sOSNfqQ95yg2H3UtatKg4Wbc91JxhRk2W2G
iKG575yGbWWFH/EjZMbmJaXHBL84gveAQNreblXk0g8dy7NzxQINoudVmYm8
CF4EjH1XMd+gOuF0WkyaGue7eqwi1xLUNxolfIe36H2f/NyuQw1vVo4L343g
1JJgpTR/FLYlnpxjP2hIF3VuEiQS/AOSwW/E
                "], {{0, 0}, {30, 1}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["900", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "900", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1.`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", "1", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.5653770593331255`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "2", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.565736938452311`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "3", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.5657644102287358`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "4", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.565510138782106`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<900>, {900}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.6648193626363697`*^9, 3.664819406195017*^9, 3.664819454742696*^9, {
   3.66481962608819*^9, 3.6648196416594753`*^9}, 3.664819677821794*^9, {
   3.6648197624249268`*^9, 3.66481976865485*^9}, 3.664819899695945*^9, 
   3.664820335374589*^9, 3.664820715235138*^9, 3.664820793978025*^9, 
   3.664820827506337*^9, 3.664820861093939*^9, 3.664823206024222*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"n", "'"}]}], "}"}], "]"}], "//", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Gratios", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "=", 
       RowBox[{"Gratios", "//", 
        RowBox[{"Gfunc", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}], "&"}]}], ",", 
   RowBox[{"10", "*", "nIter"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.664819848213181*^9, 3.664819848894265*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Max", "[", "Gratios", "]"}]], "Input",
 CellChangeTimes->{{3.664819786279892*^9, 3.664819792144926*^9}}],

Cell[BoxData["8.957696636050429`"], "Output",
 CellChangeTimes->{{3.6648197928054733`*^9, 3.664819866404703*^9}, {
   3.664820375295534*^9, 3.664820427670864*^9}, {3.6648207229706907`*^9, 
   3.664820744213728*^9}, 3.6648208040293427`*^9, 3.664820866695797*^9, 
   3.664820947223288*^9, 3.664821059988635*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"recursion", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "f"}], "}"}]}], "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6645099296880074`*^9, 3.6645099426910596`*^9}, {
  3.6645099879936166`*^9, 3.6645099894208775`*^9}, {3.664564367666822*^9, 
  3.6645643962899027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1.`", "\[VeryThinSpace]", "-", 
    FractionBox[
     RowBox[{"1.`", " ", "a", " ", "b"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.`", "\[VeryThinSpace]", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1.`", "\[VeryThinSpace]", "+", "b"}], ")"}]}]]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1.`", "\[VeryThinSpace]", "-", 
    FractionBox[
     RowBox[{"1.`", " ", "e", " ", "f"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.`", "\[VeryThinSpace]", "+", "e"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1.`", "\[VeryThinSpace]", "+", "f"}], ")"}]}]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.6645099433211555`*^9, 3.664509990839777*^9, {3.6645100428805523`*^9, 
   3.6645100726474457`*^9}, {3.664564373228908*^9, 3.664564397310843*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", "x"}], ")"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}]}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}]}]}], "\[Equal]", "x"}], ",", "x", ",", 
   "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.664819161422819*^9, 3.6648191674684353`*^9}, 
   3.664819390138405*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x", "\[Rule]", "1.5654612998934496`"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.664819168302495*^9, {3.6648193696638737`*^9, 3.664819392507646*^9}, 
   3.664819461140633*^9, 3.664819778419482*^9, 3.664819907309318*^9, 
   3.664820343292429*^9, 3.6648207469002247`*^9, 3.66482106495028*^9, 
   3.6648232185228567`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "==="}], "="}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.664553044019204*^9, 3.6645530621357183`*^9}, {
  3.664821259523979*^9, 3.664821288346642*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"hypergraph", " ", "matching"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.664547328534884*^9, 3.6645473333137283`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"recursion", "[", 
    RowBox[{"lst_", ",", "\[Lambda]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]", "/", 
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Plus", "@@", "#"}]}], ")"}], "&"}], "/@", "lst"}], 
       ")"}]}]}], "//", "N"}]}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"recursion", " ", "for", " ", "hypergraph", " ", "matching"}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeedRandom", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "100"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "vertices"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", "6"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"degree", " ", "of", " ", "a", " ", "varialbe"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"degree", " ", "of", " ", "a", " ", "clause"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "=", 
    RowBox[{"2", "^", "7"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "multiplicative", " ", "weight", " ", "for", " ", "a", " ", "variable", 
     " ", "to", " ", "be", " ", "occupied"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "'"}], "=", 
    RowBox[{"n", "*", "d"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"total", " ", "degrees"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"m", "=", 
    RowBox[{"Ceiling", "[", 
     RowBox[{
      RowBox[{"n", "'"}], "/", "k"}], "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"number", " ", "of", " ", "clauses"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"nIter", "=", 
    RowBox[{"100", "*", 
     RowBox[{"n", "'"}]}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"number", " ", "of", " ", "iterations"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"genAdj", "[", 
     RowBox[{
     "ginc_", ",", "ginc2_", ",", "gidx_", ",", "vidx_", ",", "aidx_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"b", ",", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"i", ",", 
          RowBox[{"gidx", "[", 
           RowBox[{"{", 
            RowBox[{"i", ",", "b"}], "}"}], "]"}]}], "]"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ginc2", "[", 
           RowBox[{"[", "b", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", "vidx"}], "&"}]}], "]"}]}]}], "]"}], "/@", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"ginc", "[", 
        RowBox[{"[", "vidx", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "\[NotEqual]", "aidx"}], "&"}]}], "]"}]}]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "generate", " ", "a", " ", "list", " ", "of", " ", "values", " ", "to", 
    " ", "be", " ", "fed", " ", "into", " ", "the", " ", "recurrence"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{"True", ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "keep", " ", "sampling", " ", "until", " ", "a", " ", "simple", " ", 
     "graph"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"Graph", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["v", 
              RowBox[{"Ceiling", "[", 
               RowBox[{"#1", "/", "d"}], "]"}]], " ", "\[UndirectedEdge]", 
             " ", 
             SubscriptBox["a", 
              RowBox[{"Ceiling", "[", 
               RowBox[{"#2", "/", "k"}], "]"}]]}], ")"}], "&"}], ",", "#"}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"n", "'"}], "]"}], ",", " ", 
          RowBox[{"PermutationReplace", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"n", "'"}], "]"}], ",", 
            RowBox[{"RandomPermutation", "[", 
             RowBox[{"n", "'"}], "]"}]}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
    ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "bipartite", " ", "factor", " ", "graph", " ", "from", " ", "a", " ", 
      "random", " ", "permutation"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"SimpleGraphQ", "[", "G", "]"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"if", " ", "G", " ", "is", " ", "simple"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ginc", "=", 
        RowBox[{"Association", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"AdjacencyList", "[", 
               RowBox[{"G", ",", 
                SubscriptBox["v", "i"]}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "incidence", " ", "list", " ", "as", " ", "an", " ", "associative", 
         " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Ginc2", "=", 
        RowBox[{"Association", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"AdjacencyList", "[", 
               RowBox[{"G", ",", 
                SubscriptBox["a", "i"]}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], "]"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "transpose", " ", "of", " ", "incidence", " ", "list", " ", "as", " ",
          "an", " ", "associative", " ", "list"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Glst", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
             RowBox[{"AdjacencyList", "[", 
              RowBox[{"G", ",", 
               SubscriptBox["v", "i"]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gidx", "=", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"term", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#1", " ", "\[Rule]", " ", "#2"}], ")"}], "&"}], "@@", 
             "term"}]}], "]"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Glst", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"n", "'"}], "]"}]}], "}"}], "//", "Transpose"}], 
           ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gadj", "=", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"term", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"genAdj", "[", 
              RowBox[{
              "Ginc", ",", "Ginc2", ",", "Gidx", ",", "#1", ",", "#2"}], 
              "]"}], "&"}], "@@", "term"}]}], "]"}], "/@", "Glst"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gfunc", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"term", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"lst", ",", 
                RowBox[{"recursion", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"lst", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "term", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[Lambda]"}], 
                 "]"}]}], "]"}], "&"}], "@@", "term"}]}], "]"}], "/@", 
          "Gadj"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"a", " ", "list", " ", "of", " ", "functions"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Gratios", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", "]"}], ",", 
           RowBox[{"n", "'"}]}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "initialize", " ", "ratios", " ", "with", " ", "random", " ", 
         "reals"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"n", "'"}]}], "}"}], "]"}], "//", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Gratios", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "=", 
       RowBox[{"Gratios", "//", 
        RowBox[{"Gfunc", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}], "&"}]}], ",", "nIter"}], 
  "]"}], "\[IndentingNewLine]", "Gratios"}], "Input",
 CellChangeTimes->{{3.664547299736514*^9, 3.664547313692606*^9}, {
   3.664553136045548*^9, 3.664553146784033*^9}, {3.664555110722736*^9, 
   3.664555111182523*^9}, {3.664561930721034*^9, 3.6645619850396347`*^9}, {
   3.664562047177437*^9, 3.664562050991781*^9}, {3.664564336770708*^9, 
   3.6645643437297697`*^9}, {3.664851739427023*^9, 3.664851795796666*^9}, {
   3.6648521372956877`*^9, 3.664852142525975*^9}, {3.6648521847077923`*^9, 
   3.664852185553784*^9}, 3.664852275262113*^9}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJwB5QIa/SFib1JlAwAAAAEAAAAeAAAAAwAAAJespmfbwM4/YPwp1Sks1z9l
LzI5QiDrPyFVpjyuX9A/waIjjF5H3j9lBgc+tpzsPxMYJj7ZOtE/7MAlQrMw
4j8KzOS5YePtP3EHYAGr1dA/D4YyZyPI4D9R4fZxkkztP6mMXsHoNNA/SPPq
jIgW3T+fF6oK9lzsP+IKjSatus8/3sBQDGim2j/m6mS/b9rrP7YWM3qPVs4/
mUCR1V6x1T/2y1SJCtHqPwwFG7XUudA/0YdcgPBk4D8UKf2yFCPtP1jw6Qdc
JNo/83QPGHJY5z95QnS1jFnvP1jHXFLAhNE/xiDdSw444z82iUqciFHuP+Vr
7FAlF9E/ca7ksXix4T/v67SqKq7tP66t75Eq7+M/0hTJlRkH6z+luRHSd7Xv
P7mLMEW5tOg/2EenrnyW7T/JWG3+X/XvP+54BlTezNY/Nssd4vNy5j+gQsr2
K0PvP+VdTyP1+s8/XL/svXmL2z8kIiuSVwrsPwITEQoehNU/OGbLJMMa5j8F
nWuAkjrvP47Bv62zntI/O3ys/N5T5T8PJzOoLSfvP2Z++ouCjM4/5mq/PJ9x
1j/IHiQ8P/nqPzprtRiyt+E//QdgV6TW6T+iARzBx5fvP5Oa8HYV+84/d38g
Saj71z9A9Jv2pkvrP9EQ6lr63NE/j79vs3Ry5D+KzQUXCdXuP09IqU4eTeM/
aInsiyiw6j98jUWI/azvP8K98e4QUM8/XlUC734q2T/Z/Is5/IrrP1fSg0Df
L90/1j2hio4p6D+f+h+r8G3vPzJvnREYh88/DMhmHJfu2T/I8FKp/rPrP+51
7nvTltA/CbbtgmXQ3z9R8kP/5+7sP/u6TekKo9E/MVc2JQCk4z80pT7Trn7u
Pwi5kDVsvtE/zqOkHJIF5D9vxMEufqfuP+3fPs0kIt8/dvqZ+jiv6D/kxatQ
+XrvP9pHEQmzsOU/uDG6SEj46z8s6w1d/MzvPy7DeJI=
                "], {{0, 0}, {30, 1}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["600", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "600", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJwB5QIa/SFib1JlAwAAAAEAAAAeAAAAAwAAAJespmfbwM4/YPwp1Sks1z9l
LzI5QiDrPyFVpjyuX9A/waIjjF5H3j9lBgc+tpzsPxMYJj7ZOtE/7MAlQrMw
4j8KzOS5YePtP3EHYAGr1dA/D4YyZyPI4D9R4fZxkkztP6mMXsHoNNA/SPPq
jIgW3T+fF6oK9lzsP+IKjSatus8/3sBQDGim2j/m6mS/b9rrP7YWM3qPVs4/
mUCR1V6x1T/2y1SJCtHqPwwFG7XUudA/0YdcgPBk4D8UKf2yFCPtP1jw6Qdc
JNo/83QPGHJY5z95QnS1jFnvP1jHXFLAhNE/xiDdSw444z82iUqciFHuP+Vr
7FAlF9E/ca7ksXix4T/v67SqKq7tP66t75Eq7+M/0hTJlRkH6z+luRHSd7Xv
P7mLMEW5tOg/2EenrnyW7T/JWG3+X/XvP+54BlTezNY/Nssd4vNy5j+gQsr2
K0PvP+VdTyP1+s8/XL/svXmL2z8kIiuSVwrsPwITEQoehNU/OGbLJMMa5j8F
nWuAkjrvP47Bv62zntI/O3ys/N5T5T8PJzOoLSfvP2Z++ouCjM4/5mq/PJ9x
1j/IHiQ8P/nqPzprtRiyt+E//QdgV6TW6T+iARzBx5fvP5Oa8HYV+84/d38g
Saj71z9A9Jv2pkvrP9EQ6lr63NE/j79vs3Ry5D+KzQUXCdXuP09IqU4eTeM/
aInsiyiw6j98jUWI/azvP8K98e4QUM8/XlUC734q2T/Z/Is5/IrrP1fSg0Df
L90/1j2hio4p6D+f+h+r8G3vPzJvnREYh88/DMhmHJfu2T/I8FKp/rPrP+51
7nvTltA/CbbtgmXQ3z9R8kP/5+7sP/u6TekKo9E/MVc2JQCk4z80pT7Trn7u
Pwi5kDVsvtE/zqOkHJIF5D9vxMEufqfuP+3fPs0kIt8/dvqZ+jiv6D/kxatQ
+XrvP9pHEQmzsOU/uDG6SEj46z8s6w1d/MzvPy7DeJI=
                "], {{0, 0}, {30, 1}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["600", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "600", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1.`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", "1", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.017792157116303036`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "2", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.014039285126292617`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "3", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.41908181378288767`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "4", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.4645205832274344`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<600>, {600}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.664851778977685*^9, 3.6648518012572823`*^9}, 
   3.6648521259037123`*^9, {3.664852167897859*^9, 3.66485218865633*^9}, 
   3.6648522789734383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"recursion", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "f"}], "}"}]}], "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.664561987048993*^9, 3.664562032471703*^9}, {
  3.66456436140202*^9, 3.664564362177944*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1.`", "\[VeryThinSpace]", "+", "a", "+", "b"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1.`", "\[VeryThinSpace]", "+", "e", "+", "f"}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.664561996444479*^9, 3.664562056203123*^9}, {
  3.664564350986019*^9, 3.664564363278019*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]", "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", "-", "1"}], ")"}], "#"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]}], "&"}], "[", 
     RowBox[{"\[Lambda]", "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k", "-", "1"}], ")"}], "x"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], "]"}], "\[Equal]", "x"}], ",", 
   "x", ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.6645625573212967`*^9, 3.664562592248273*^9}, {
  3.66456269052073*^9, 3.664562702961533*^9}, {3.664852263277948*^9, 
  3.6648522677434263`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "1.6882890388300267`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", "0.8599367177309283`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", "1.1416799007728628`*^-10"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.664562592890191*^9, 3.664562704610106*^9, 3.664563074641823*^9, 
   3.664563384624482*^9, 3.664852173746861*^9, {3.6648522437407103`*^9, 
   3.66485228553925*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"n", "'"}]}], "}"}], "]"}], "//", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Gratios", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "=", 
       RowBox[{"Gratios", "//", 
        RowBox[{"Gfunc", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}], "&"}]}], ",", 
   RowBox[{"10", "*", "nIter"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.664819848213181*^9, 3.664819848894265*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Max", "[", "Gratios", "]"}]], "Input",
 CellChangeTimes->{{3.664819786279892*^9, 3.664819792144926*^9}}],

Cell[BoxData["125.65131657560131`"], "Output",
 CellChangeTimes->{3.664852234730823*^9, 3.664852311659707*^9, 
  3.664852440921185*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "the", " ", "following", " ", "codes", " ", "are", " ", "deprecated"}], " ",
   "*)"}]], "Input",
 CellChangeTimes->{{3.664820119748435*^9, 3.664820127546609*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SeedRandom", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "1200"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"number", " ", "of", " ", "vertices"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"degree", " ", "of", " ", "a", " ", "varialbe"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", "=", "6"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"degree", " ", "of", " ", "a", " ", "clause"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"n", "'"}], "=", 
     RowBox[{"n", "*", "d"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"total", " ", "degrees"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"Ceiling", "[", 
      RowBox[{
       RowBox[{"n", "'"}], "/", "k"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"number", " ", "of", " ", "clauses"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"While", "[", 
    RowBox[{"True", ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "keep", " ", "sampling", " ", "until", " ", "a", " ", "simple", " ", 
       "graph"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["v", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"#1", "/", "d"}], "]"}]], " ", "\[UndirectedEdge]", 
               " ", 
               SubscriptBox["a", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"#2", "/", "k"}], "]"}]]}], ")"}], "&"}], ",", "#"}],
            "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"n", "'"}], "]"}], ",", " ", 
            RowBox[{"PermutationReplace", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"n", "'"}], "]"}], ",", 
              RowBox[{"RandomPermutation", "[", 
               RowBox[{"n", "'"}], "]"}]}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "bipartite", " ", "factor", " ", "graph", " ", "from", " ", "a", " ", 
        "random", " ", "permutation"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SimpleGraphQ", "[", "G", "]"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"if", " ", "G", " ", "is", " ", "simple"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ginc", "=", 
          RowBox[{"Association", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
                RowBox[{"AdjacencyList", "[", 
                 RowBox[{"G", ",", 
                  SubscriptBox["v", "i"]}], "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";",
          " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "incidence", " ", "list", " ", "as", " ", "an", " ", "associative", 
           " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Ginc2", "=", 
          RowBox[{"Association", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
                RowBox[{"AdjacencyList", "[", 
                 RowBox[{"G", ",", 
                  SubscriptBox["a", "i"]}], "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], "]"}]}], ";",
          " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "transpose", " ", "of", " ", "incidence", " ", "list", " ", "as", 
           " ", "an", " ", "associative", " ", "list"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Gfunc", "=", 
          RowBox[{"Function", "[", 
           RowBox[{"lst", ",", 
            RowBox[{"Association", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "\[Rule]", 
                   RowBox[{"recursion", "[", 
                    RowBox[{
                    RowBox[{"genAdj", "[", 
                    RowBox[{"Ginc", ",", "Ginc2", ",", "lst", ",", "i", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "1"}], 
                    "]"}]}], "&"}], "/@", 
                 RowBox[{"AdjacencyList", "[", 
                  RowBox[{"G", ",", 
                   SubscriptBox["v", "i"]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], 
             "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "a", " ", "map", " ", "from", " ", "Association", " ", "to", " ", 
            "Association"}], ",", " ", 
           RowBox[{
           "one", " ", "iteration", " ", "for", " ", "BP", " ", "update"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Gratios", "=", 
          RowBox[{"Association", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "\[Rule]", " ", 
                 RowBox[{"RandomReal", "[", "]"}]}], "&"}], "/@", 
               RowBox[{"AdjacencyList", "[", 
                RowBox[{"G", ",", 
                 SubscriptBox["v", "i"]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], 
           "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "initialize", " ", "ratios", " ", "with", " ", "random", " ", 
           "reals"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.664553107587625*^9, 3.664553113203532*^9}, {
   3.664563070164225*^9, 3.664563071713853*^9}, {3.664563230210094*^9, 
   3.6645632329000683`*^9}, {3.6645633260020123`*^9, 3.664563345338439*^9}, {
   3.6645633762262077`*^9, 3.66456337738601*^9}, {3.664564411323188*^9, 
   3.66456441166691*^9}, 3.664565621714127*^9, {3.6645657244494133`*^9, 
   3.6645657297253857`*^9}, 3.664567783799698*^9, {3.66456789952855*^9, 
   3.664567902722828*^9}, 3.6645698597904263`*^9, {3.664569909196727*^9, 
   3.664569934660619*^9}, {3.664570038538961*^9, 3.664570046418489*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Nest", "[", 
   RowBox[{"Gfunc", ",", "Gratios", ",", "80"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.664563109232939*^9, 3.664563111808681*^9}, {
   3.6645644271063843`*^9, 3.6645644573698606`*^9}, 3.664569980772524*^9, {
   3.664570026141317*^9, 3.664570026936907*^9}, {3.664570065601376*^9, 
   3.664570069797715*^9}}]
},
WindowSize->{1918, 528},
WindowMargins->{{0, Automatic}, {2, Automatic}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 414, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[997, 32, 11829, 310, 618, "Input"],
Cell[12829, 344, 11160, 219, 69, "Output"]
}, Open  ]],
Cell[24004, 566, 560, 17, 32, "Input"],
Cell[CellGroupData[{
Cell[24589, 587, 128, 2, 32, "Input"],
Cell[24720, 591, 309, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25066, 600, 414, 11, 32, "Input"],
Cell[25483, 613, 843, 23, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26363, 641, 605, 19, 32, "Input"],
Cell[26971, 662, 383, 8, 32, "Output"]
}, Open  ]],
Cell[27369, 673, 624, 11, 77, "Input"],
Cell[27996, 686, 168, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[28189, 693, 10531, 288, 618, "Input"],
Cell[38723, 983, 10975, 216, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49735, 1204, 354, 10, 32, "Input"],
Cell[50092, 1216, 353, 9, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50482, 1230, 884, 27, 32, "Input"],
Cell[51369, 1259, 519, 14, 32, "Output"]
}, Open  ]],
Cell[51903, 1276, 560, 17, 32, "Input"],
Cell[CellGroupData[{
Cell[52488, 1297, 128, 2, 32, "Input"],
Cell[52619, 1301, 135, 2, 65, "Output"]
}, Open  ]],
Cell[52769, 1306, 211, 5, 32, "Input"],
Cell[52983, 1313, 7723, 192, 420, "Input"],
Cell[60709, 1507, 369, 7, 32, "Input"]
}
]
*)

(* End of internal cache information *)
